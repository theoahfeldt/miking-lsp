let fix = <. (<. (join id) (~ ap id)) <. in
let .> = ~ <. in
let <: = <. <. <. in
let <=< = <. (<: join) <: in

let true = const in
let false = ~ true in
let lt = ~ gt in
let or = join id in
let and = join (<. ~ id) in
let |> = ~ id in

let fact = fix (<: (|> 1)
                   (<. (ap (lt 1))
                   (<=< mul
                        (.> (add -1))))) in

fact 4